[0m11:51:34.750262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a49d5ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a4a0732d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a4a073410>]}


============================== 11:51:34.756875 | 34e1c710-0c52-47a7-baf7-21ea53d1b2ac ==============================
[0m11:51:34.756875 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:51:34.758190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/content/my_dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:51:35.570990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34e1c710-0c52-47a7-baf7-21ea53d1b2ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a466bba10>]}
[0m11:51:35.718406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34e1c710-0c52-47a7-baf7-21ea53d1b2ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a4c2eef90>]}
[0m11:51:35.737010 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m11:51:35.936954 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:51:35.938679 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:51:35.939696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '34e1c710-0c52-47a7-baf7-21ea53d1b2ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a49e1dc50>]}
[0m11:51:37.629956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34e1c710-0c52-47a7-baf7-21ea53d1b2ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a452f3e90>]}
[0m11:51:37.696690 [debug] [MainThread]: Wrote artifact WritableManifest to /content/my_dbt_project/target/manifest.json
[0m11:51:37.699306 [debug] [MainThread]: Wrote artifact SemanticManifest to /content/my_dbt_project/target/semantic_manifest.json
[0m11:51:37.758056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34e1c710-0c52-47a7-baf7-21ea53d1b2ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a467ae390>]}
[0m11:51:37.758909 [info ] [MainThread]: Found 1 model, 428 macros
[0m11:51:37.759564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34e1c710-0c52-47a7-baf7-21ea53d1b2ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a49f724d0>]}
[0m11:51:37.762243 [info ] [MainThread]: 
[0m11:51:37.762967 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:51:37.763554 [info ] [MainThread]: 
[0m11:51:37.764366 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:51:37.765790 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb'
[0m11:51:37.865303 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb"
[0m11:51:37.866069 [debug] [ThreadPool]: On list_my_duckdb: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_my_duckdb"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb"'
    
  
  
[0m11:51:37.866640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:37.885106 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m11:51:37.887483 [debug] [ThreadPool]: On list_my_duckdb: Close
[0m11:51:37.889207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb, now create_my_duckdb_main)
[0m11:51:37.890191 [debug] [ThreadPool]: Creating schema "database: "my_duckdb"
schema: "main"
"
[0m11:51:37.899656 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_main"
[0m11:51:37.900352 [debug] [ThreadPool]: On create_my_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "create_my_duckdb_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb'
        and type='sqlite'
    
  
[0m11:51:37.900892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:37.906104 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m11:51:37.908274 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_main"
[0m11:51:37.908890 [debug] [ThreadPool]: On create_my_duckdb_main: BEGIN
[0m11:51:37.909816 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:51:37.910331 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_main"
[0m11:51:37.910858 [debug] [ThreadPool]: On create_my_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "create_my_duckdb_main"} */

    
    
        create schema if not exists "my_duckdb"."main"
    
[0m11:51:37.911846 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:51:37.913131 [debug] [ThreadPool]: On create_my_duckdb_main: COMMIT
[0m11:51:37.913711 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_main"
[0m11:51:37.914187 [debug] [ThreadPool]: On create_my_duckdb_main: COMMIT
[0m11:51:37.915040 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:51:37.915618 [debug] [ThreadPool]: On create_my_duckdb_main: Close
[0m11:51:37.917639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_duckdb_main, now list_my_duckdb_main)
[0m11:51:37.925289 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_main"
[0m11:51:37.926017 [debug] [ThreadPool]: On list_my_duckdb_main: BEGIN
[0m11:51:37.926604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:37.927743 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:51:37.928244 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_main"
[0m11:51:37.928763 [debug] [ThreadPool]: On list_my_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_my_duckdb_main"} */
select
      'my_duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb'
  
[0m11:51:37.973233 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m11:51:37.975881 [debug] [ThreadPool]: On list_my_duckdb_main: ROLLBACK
[0m11:51:37.977282 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_main'
[0m11:51:37.978090 [debug] [ThreadPool]: On list_my_duckdb_main: Close
[0m11:51:37.980356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34e1c710-0c52-47a7-baf7-21ea53d1b2ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a45529390>]}
[0m11:51:37.981286 [debug] [MainThread]: Using duckdb connection "master"
[0m11:51:37.981857 [debug] [MainThread]: On master: BEGIN
[0m11:51:37.982355 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:51:37.983503 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:51:37.984080 [debug] [MainThread]: On master: COMMIT
[0m11:51:37.984966 [debug] [MainThread]: Using duckdb connection "master"
[0m11:51:37.985504 [debug] [MainThread]: On master: COMMIT
[0m11:51:37.986477 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:51:37.987039 [debug] [MainThread]: On master: Close
[0m11:51:37.990269 [debug] [Thread-1 (]: Began running node model.my_dbt_project.orders_with_products
[0m11:51:37.991187 [info ] [Thread-1 (]: 1 of 1 START sql view model main.orders_with_products .......................... [RUN]
[0m11:51:37.992321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_duckdb_main, now model.my_dbt_project.orders_with_products)
[0m11:51:37.992976 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.orders_with_products
[0m11:51:38.001766 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.orders_with_products"
[0m11:51:38.002962 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.orders_with_products
[0m11:51:38.050259 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.orders_with_products"
[0m11:51:38.051670 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.orders_with_products"
[0m11:51:38.052318 [debug] [Thread-1 (]: On model.my_dbt_project.orders_with_products: BEGIN
[0m11:51:38.052935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:38.054201 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:38.054837 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.orders_with_products"
[0m11:51:38.055429 [debug] [Thread-1 (]: On model.my_dbt_project.orders_with_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.orders_with_products"} */

  
  create view "my_duckdb"."main"."orders_with_products__dbt_tmp" as (
    SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.quantity,
    o.unit_price AS order_unit_price,
    p.product_name,
    p.category,
    p.unit_price AS product_unit_price,
    (o.quantity * o.unit_price) AS total_order_price
FROM
    raw_orders o
JOIN
    raw_products p
ON
    o.product_id = p.product_id
  );

[0m11:51:38.056905 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:38.065099 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.orders_with_products"
[0m11:51:38.065786 [debug] [Thread-1 (]: On model.my_dbt_project.orders_with_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.orders_with_products"} */
alter view "my_duckdb"."main"."orders_with_products__dbt_tmp" rename to "orders_with_products"
[0m11:51:38.066996 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:38.079665 [debug] [Thread-1 (]: On model.my_dbt_project.orders_with_products: COMMIT
[0m11:51:38.080428 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.orders_with_products"
[0m11:51:38.081075 [debug] [Thread-1 (]: On model.my_dbt_project.orders_with_products: COMMIT
[0m11:51:38.088095 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:51:38.095445 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.orders_with_products"
[0m11:51:38.096173 [debug] [Thread-1 (]: On model.my_dbt_project.orders_with_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.orders_with_products"} */
drop view if exists "my_duckdb"."main"."orders_with_products__dbt_backup" cascade
[0m11:51:38.097321 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:38.100618 [debug] [Thread-1 (]: On model.my_dbt_project.orders_with_products: Close
[0m11:51:38.103510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e1c710-0c52-47a7-baf7-21ea53d1b2ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a4411a0d0>]}
[0m11:51:38.104628 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.orders_with_products ..................... [[32mOK[0m in 0.11s]
[0m11:51:38.105576 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.orders_with_products
[0m11:51:38.107506 [debug] [MainThread]: Using duckdb connection "master"
[0m11:51:38.108108 [debug] [MainThread]: On master: BEGIN
[0m11:51:38.108622 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:51:38.109726 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:51:38.110255 [debug] [MainThread]: On master: COMMIT
[0m11:51:38.110833 [debug] [MainThread]: Using duckdb connection "master"
[0m11:51:38.111437 [debug] [MainThread]: On master: COMMIT
[0m11:51:38.112453 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:51:38.113021 [debug] [MainThread]: On master: Close
[0m11:51:38.113820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:38.114312 [debug] [MainThread]: Connection 'model.my_dbt_project.orders_with_products' was properly closed.
[0m11:51:38.114879 [info ] [MainThread]: 
[0m11:51:38.115463 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m11:51:38.116476 [debug] [MainThread]: Command end result
[0m11:51:38.139039 [debug] [MainThread]: Wrote artifact WritableManifest to /content/my_dbt_project/target/manifest.json
[0m11:51:38.141507 [debug] [MainThread]: Wrote artifact SemanticManifest to /content/my_dbt_project/target/semantic_manifest.json
[0m11:51:38.149709 [debug] [MainThread]: Wrote artifact RunExecutionResult to /content/my_dbt_project/target/run_results.json
[0m11:51:38.150731 [info ] [MainThread]: 
[0m11:51:38.151825 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:51:38.152745 [info ] [MainThread]: 
[0m11:51:38.153731 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:51:38.156435 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.5362678, "process_in_blocks": "24960", "process_kernel_time": 0.638674, "process_mem_max_rss": "147668", "process_out_blocks": "13960", "process_user_time": 5.417181}
[0m11:51:38.159236 [debug] [MainThread]: Command `dbt run` succeeded at 11:51:38.157305 after 3.54 seconds
[0m11:51:38.160328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a49dbb010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a45208e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a4d8f2410>]}
[0m11:51:38.161396 [debug] [MainThread]: Flushing usage events
[0m11:51:38.410849 [debug] [MainThread]: An error was encountered while trying to flush usage events
